IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'QLCHmoi')
	DROP DATABASE QLCHmoi
GO

CREATE DATABASE QLCHmoi
GO
USE QLCHmoi
GO
------------------------------------
---------T?o các b?ng---------------
------------------------------------

-----------------------------------
----------KHÁCH HÀNG-------------
------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'KHACHHANG')
	DROP DATABASE KHACHHANG
GO
CREATE TABLE KHACHHANG
(
	MAKH VARCHAR(6)NOT NULL,
	HOTEN NVARCHAR(30) NULL,
	DIACHI NVARCHAR(50)NULL,
	DIENTHOAI VARCHAR(11)NULL
)
GO

-------------------------------------
-----------L?AI NHÂN VIÊN------------
-------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'LOAINHANVIEN')
	DROP DATABASE LOAINHANVIEN
GO

CREATE TABLE LOAINHANVIEN
(
	MALOAINV VARCHAR(6) NOT NULL,
	TENLOAINV NVARCHAR(20) NULL
)
GO

-------------------------------------
------------GI?I TÍNH-----------------
--------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'GIOITINH')
	DROP DATABASE GIOITINH
GO 
CREATE TABLE GIOITINH
(
	GIOITINH VARCHAR(6)NOT NULL,
	TENGIOITINH NVARCHAR(10) NULL
)
GO

------------------------------------
-----------NHÂN VIÊN----------------
------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'NHANVIEN')
	DROP DATABASE NHANVIEN
GO
CREATE TABLE NHANVIEN
(
	MANV VARCHAR(6) NOT NULL,
	HOTEN NVARCHAR(30) NULL,
	DIACHI NVARCHAR(50) NULL,
	NGAYSINH DATETIME NULL,
	GIOITINH VARCHAR(6) NULL,
	DIENTHOAI VARCHAR(11)NULL,
	USERNAME VARCHAR(50)NULL,
	PASSWORDS VARCHAR(50)NULL,
	LOAINV VARCHAR(6) NULL
)
GO

--------------------------------------
-----------NHÀ CUNG C?P---------------
--------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'NHACUNGCAP')
	DROP DATABASE NHACUNGCAP
GO
CREATE TABLE NHACUNGCAP
(
	MANCC VARCHAR(6) NOT NULL,
	TENNCC NVARCHAR(30) NULL,
	DIACHI NVARCHAR(40) NULL,
	DIENTHOAI VARCHAR(11)NULL
)
GO

--------------------------------------
------------ÐON V? TÍNH---------------
--------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'DONVITINH')
	DROP DATABASE DONVITINH
GO
CREATE TABLE DONVITINH
(
	MADVT VARCHAR(6) NOT NULL,
	TENDVT NVARCHAR(30) NULL
)
GO

--------------------------------------
------------HÀNG HÓA----------------
------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'HANGHOA')
	DROP DATABASE HANGHOA
GO
CREATE TABLE HANGHOA
(
	MAHH VARCHAR(6) NOT NULL,
	TENHH NVARCHAR(30) NULL,
	MADVT VARCHAR(6)NULL,	
	NGAYHETHAN DATETIME NULL,
	SOLUONG INT NULL,
	SOLUONGGIAM INT NULL,
	TILEGIAM INT NULL
)
GO

-------------------------------------
------------PHI?U BÁN HÀNG-----------
-------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'PHIEUBANHANG')
	DROP DATABASE PHIEUBANHANG
GO
CREATE TABLE PHIEUBANHANG
(
	MAPHIEU VARCHAR(6) NOT NULL,
	MAKH VARCHAR(6)NOT NULL,
	MANV VARCHAR(6)NOT NULL,	
	NGAYLAP DATETIME NULL,
	TONGTIEN INT NULL
	
)
GO

-----------------------------------
----------PHI?U Ð?T HÀNG-----------
-----------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'PHIEUDATHANG')
	DROP DATABASE PHIEUDATHANG
GO
CREATE TABLE PHIEUDATHANG
(
	MAPHIEUDATHANG VARCHAR(6) NOT NULL,
	MANCC VARCHAR(6)NOT NULL,
	MANV VARCHAR(6) NOT NULL,
	NGAYLAP DATETIME NULL,
	
)
GO

----------------------------------------
-----------PHI?U NH?N HÀNG--------------
-----------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'PHIEUNHANHANG')
	DROP DATABASE PHIEUNHANHANG
GO
CREATE TABLE PHIEUNHANHANG
(
	MAPHIEU VARCHAR(6) NOT NULL,
	MANCC VARCHAR(6)NOT NULL,
	MANV VARCHAR(6)NOT NULL,	
	NGAYLAP DATETIME NULL,
	TONGTIEN INT NULL
	
)
GO

--------------------------------------------
------------CHI TI?T PHI?U BÁN HÀNG----------
--------------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'CHITIETPHIEUBANHANG')
	DROP DATABASE CHITIETPHIEUBANHANG
GO
CREATE TABLE CHITIETPHIEUBANHANG
(
	MAPHIEU VARCHAR(6) NOT NULL,
	MASP VARCHAR(6)NOT NULL,
	DONGIA INT NULL,
	SOLUONG INT NULL,
	THANHTIEN INT NULL
)
GO

-----------------------------------------------
------------CHI TI?T PHI?U Ð?T HÀNG-----------
----------------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'CHITIETPHIEUDATHANG')
	DROP DATABASE CHITIETPHIEUDATHANG
GO
CREATE TABLE CHITIETPHIEUDATHANG
(
	MAPHIEUDATHANG VARCHAR(6) NOT NULL,
	MASP VARCHAR(6)NOT NULL,
	SOLUONG INT NULL
)
GO

---------------------------------------------
----------CHI TI?T PHI?U NH?N HÀNG------------
---------------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'CHITIETPHIEUNHANHANG')
	DROP DATABASE CHITIETPHIEUNHANHANG
GO
CREATE TABLE CHITIETPHIEUNHANHANG
(
	MAPHIEU VARCHAR(6) NOT NULL,
	MASP VARCHAR(6) NOT NULL,
	DONGIA INT NULL,
	SOLUONG INT NULL,
	THANHTIEN INT NULL,
	MAPHIEUDATHANG VARCHAR(6)NOT NULL  
)
GO

-----------------------------------------------
----------------PHI?U S? C?--------------------
------------------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'PHIEUSUCO')
	DROP DATABASE PHIEUSUCO
GO
CREATE TABLE PHIEUSUCO
(
	MAPHIEUSUCO VARCHAR(6) NOT NULL,
	MASP VARCHAR(6) NOT NULL,
	NGAYHUHONG DATETIME NULL,
	LYDO VARCHAR(1000) NULL,
	SOLUONGHUHONG INT NULL,
	DONGIA INT NULL,
	TONGTIENHUHONG INT NULL
)
GO

-----------------------------------------------
-----------------T?N KHO-------------------
-----------------------------------------------
IF EXISTS (SELECT * 
	   FROM   master..sysdatabases 
	   WHERE  name = N'TONKHO')
	DROP DATABASE TONKHO
GO
CREATE TABLE TONKHO
(
	THANG DATETIME NOT NULL,
	NAM DATETIME NOT NULL,
	MASP VARCHAR(6)NOT NULL,
	SLTON INT NULL
)
GO

------------------------------------------
--==========T?O KHÓA CHÍNH==============
------------------------------------------
ALTER TABLE KHACHHANG
ADD CONSTRAINT P_MAKH PRIMARY KEY(MAKH)

ALTER TABLE LOAINHANVIEN
ADD CONSTRAINT P_MALOAINV PRIMARY KEY(MALOAINV)

ALTER TABLE GIOITINH
ADD CONSTRAINT P_GIOITINH PRIMARY KEY(GIOITINH)

ALTER TABLE NHANVIEN
ADD CONSTRAINT P_MANV PRIMARY KEY(MANV)

ALTER TABLE NHACUNGCAP
ADD CONSTRAINT P_MANCC PRIMARY KEY(MANCC)

ALTER TABLE DONVITINH
ADD CONSTRAINT P_MADVT PRIMARY KEY(MADVT)

ALTER TABLE HANGHOA
ADD CONSTRAINT P_MAHH PRIMARY KEY(MAHH)

ALTER TABLE PHIEUBANHANG
ADD CONSTRAINT P_MAPHIEU PRIMARY KEY(MAPHIEU)

ALTER TABLE PHIEUDATHANG
ADD CONSTRAINT P_MAPHIEUDATHANG PRIMARY KEY(MAPHIEUDATHANG)

ALTER TABLE PHIEUNHANHANG
ADD CONSTRAINT PN_MAPHIEU PRIMARY KEY(MAPHIEU)

ALTER TABLE CHITIETPHIEUBANHANG
ADD CONSTRAINT P_CT_PBH PRIMARY KEY(MAPHIEU,MASP)

ALTER TABLE CHITIETPHIEUDATHANG
ADD CONSTRAINT P_CT_PDH PRIMARY KEY(MAPHIEUDATHANG,MASP)

ALTER TABLE CHITIETPHIEUNHANHANG
ADD CONSTRAINT P_CT_PNH PRIMARY KEY(MAPHIEU,MASP)

ALTER TABLE PHIEUSUCO
ADD CONSTRAINT P_MAPHIEUSUCO PRIMARY KEY(MAPHIEUSUCO)

ALTER TABLE TONKHO
ADD CONSTRAINT P_TONKHO PRIMARY KEY(THANG,NAM)

----------------------------------------------
--=============T?O KHÓA NGO?I================
----------------------------------------------
ALTER TABLE NHANVIEN 
ADD CONSTRAINT F_NV_GIOITINH FOREIGN KEY(GIOITINH) REFERENCES GIOITINH(GIOITINH)

ALTER TABLE NHANVIEN 
ADD CONSTRAINT F_NV_LOAINHANVIEN FOREIGN KEY(LOAINV) REFERENCES LOAINHANVIEN(MALOAINV)

ALTER TABLE HANGHOA 
ADD CONSTRAINT F_HANGHOA_DONVITINH FOREIGN KEY(MADVT) REFERENCES DONVITINH(MADVT)

ALTER TABLE PHIEUBANHANG 
ADD CONSTRAINT F_PHIEUBANHANG_KHACHHANG FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH)

ALTER TABLE PHIEUBANHANG 
ADD CONSTRAINT F_PBH_NHANVIEN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)

ALTER TABLE PHIEUDATHANG 
ADD CONSTRAINT F_PDH_NHACUNGCAP FOREIGN KEY(MANCC) REFERENCES NHACUNGCAP(MANCC)

ALTER TABLE PHIEUDATHANG 
ADD CONSTRAINT F_PDH_NHANVIEN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)

ALTER TABLE PHIEUNHAHANG 
ADD CONSTRAINT FF_PNH_NHACUNGCAP FOREIGN KEY(MANCC) REFERENCES NHACUNGCAP(MANCC)

ALTER TABLE PHIEUNHANHANG 
ADD CONSTRAINT F_PNH_NHANVIEN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)

ALTER TABLE CHITIETPHIEUBANHANG 
ADD CONSTRAINT FF_CTPBH_PBH FOREIGN KEY(MAPHIEU) REFERENCES PHIEUBANHANG(MAPHIEU)

ALTER TABLE CHITIETPHIEUBANHANG 
ADD CONSTRAINT F_CTPBH_HH FOREIGN KEY(MASP) REFERENCES HANGHOA(MAHH)

ALTER TABLE CHITIETPHIEUDATHANG 
ADD CONSTRAINT F_CTPDH_PDH FOREIGN KEY(MAPHIEUDATHANG) REFERENCES PHIEUDATHANG(MAPHIEUDATHANG)

ALTER TABLE CHITIETPHIEUDATHANG 
ADD CONSTRAINT F_CTPDH_HH FOREIGN KEY(MASP) REFERENCES HANGHOA(MAHH)

ALTER TABLE CHITIETPHIEUNHANHANG 
ADD CONSTRAINT F_CTPNH_PNH FOREIGN KEY(MAPHIEU) REFERENCES PHIEUNHANHANG(MAPHIEU)

ALTER TABLE CHITIETPHIEUNHANHANG 
ADD CONSTRAINT F_CTPNH_HH FOREIGN KEY(MASP) REFERENCES HANGHOA(MAHH)

ALTER TABLE PHIEUSUCO 
ADD CONSTRAINT F_PSC_HH FOREIGN KEY(MASP) REFERENCES HANGHOA(MAHH)

ALTER TABLE TONKHO 
ADD CONSTRAINT F_TONKHO_HH FOREIGN KEY(MASP) REFERENCES HANGHOA(MAHH)

-----------------------------------------------
--==============NH?P LI?U ====================
-----------------------------------------------

--------------KHÁCH HÀNG-----------------
INSERT INTO KHACHHANG
VALUES('KH001','NGUYEN VAN A','THOAI SON','123456')

INSERT INTO KHACHHANG
VALUES('KH002','NGUYEN THI THANH','CHAU DOC','234567')

INSERT INTO KHACHHANG
VALUES('KH003','TRAN NGUYEN ANH THU','CHAU THANH','687456')

INSERT INTO KHACHHANG
VALUES('KH004','LE TRAN NGUYEN','THOAI SON','781236')

INSERT INTO KHACHHANG
VALUES('KH005','BUI DUC THINH','CAO LANH','124756')

-----------------LO?I NHÂN VIÊN----------------
INSERT INTO LOAINHANVIEN
VALUES('MNV001','QUAN LY')

INSERT INTO LOAINHANVIEN
VALUES('MNV002','BAN HANG')

---------------GI?I TÍNH--------------------
INSERT INTO GIOITINH
VALUES('GT001','NAM')

INSERT INTO GIOITINH
VALUES('GT002','NU')

---------------NHÂN VIÊN------------------
INSERT INTO NHANVIEN
VALUES ('NV001','MAC THI HONG LAM','DONG THAP','10/10/1984','NU','012345','admin1','admin1','MNV001')

INSERT INTO NHANVIEN
VALUES ('NV002','TRAN QUOC TRUNG','TINH BIEN','05/11/1986','NAM','122345','admin2','admin2','MNV001')

INSERT INTO NHANVIEN
VALUES ('NV003','NGUYEN THI HONG VAN','CHAU DOC','12/05/1985','NU','067954','user1','user1','MNV002')

INSERT INTO NHANVIEN
VALUES ('NV004','CHE THI MAI HIEU','SA DEC','11/01/1987','NU','123489','user2','user2','MNV002')

INSERT INTO NHANVIEN
VALUES ('NV005','PHAM PHUOC NGUYEN','PHU TAN','02/03/1981','NAM','698745','user3','user3','MNV002')

------------------NHÀ CUNG C?P------------------
INSERT INTO NHACUNGCAP
VALUES ('NCC001','NHA MAY THUOC LA ÐONG THAP','CAO LANH-ÐONG THAP','067987455')

INSERT INTO NHACUNGCAP
VALUES ('NCC002','NHA MAY BAI SAI GON','NGUYEN CHI THANH-TP HCM','08987455')

INSERT INTO NHACUNGCAP
VALUES ('NCC003','CTY DUOC HAU GIANG','CAN THO','071897455')

INSERT INTO NHACUNGCAP
VALUES ('NCC004','CTY BANH KEO BIEN HOA','BIEN HOA','0917987455')

----------------ÐON V? TÍNH---------------------
INSERT INTO DONVITINH
VALUES ('DVT001','KILOGAM')

INSERT INTO DONVITINH
VALUES ('DVT002','GOI')

INSERT INTO DONVITINH
VALUES ('DVT003','KET')

INSERT INTO DONVITINH
VALUES ('DVT004','BIT')

INSERT INTO DONVITINH
VALUES ('DVT005','THUNG')

-----------------HÀNG HÓA----------------------
INSERT INTO HANGHOA
VALUES ('HH001','BIA SAI GON','DVT003','11/10/2008','200','20','5')

INSERT INTO HANGHOA
VALUES ('HH002','KEO','DVT004','04/06/2007','300','100','10')

INSERT INTO HANGHOA
VALUES ('HH003','ÐUONG','DVT001','10/12/2006','500','50','5')

INSERT INTO HANGHOA
VALUES ('HH004','THUOC LA','DVT002','01/01/2008','200','10','5')

INSERT INTO HANGHOA
VALUES ('HH005','THUOC TAY','DVT005','06/06/2006','100','10','10')

INSERT INTO HANGHOA
VALUES ('HH006','MUOI','DVT002','10/04/2008','400','50','10')

----------PHI?U BÁN HÀNG---------------------
INSERT INTO PHIEUBANHANG
VALUES ('PBH001','KH001','NV002','10/11/2006','')

INSERT INTO PHIEUBANHANG
VALUES ('PBH002','KH004','NV003','08/10/2007','')

INSERT INTO PHIEUBANHANG
VALUES ('PBH003','KH002','NV001','12/04/2007','')

INSERT INTO PHIEUBANHANG
VALUES ('PBH004','KH001','NV004','05/09/2005','')

-----------PHI?U Ð?T HÀNG---------------------
INSERT INTO PHIEUDATHANG
VALUES ('PDH001','NCC001','NV002','10/11/2006')

INSERT INTO PHIEUDATHANG
VALUES ('PDH002','NCC002','NV004','07/10/2007')

INSERT INTO PHIEUDATHANG
VALUES ('PDH003','NCC004','NV001','01/06/2006')

-------------PHI?U NH?N HÀNG------------------
INSERT INTO PHIEUNHANHANG
VALUES ('PNH001','NCC001','NV001','01/06/2007','')

INSERT INTO PHIEUNHANHANG
VALUES ('PNH002','NCC004','NV002','10/10/2006','')

INSERT INTO PHIEUNHANHANG
VALUES ('PNH003','NCC003','NV005','11/12/2006','')

-------------CHI TI?T PHI?U BÁN HÀNG------------
INSERT INTO CHITIETPHIEUBANHANG
VALUES ('PBH001','HH002','3000','100','300000')

INSERT INTO CHITIETPHIEUBANHANG
VALUES ('PBH002','HH001','5000','1000','5000000')

INSERT INTO CHITIETPHIEUBANHANG
VALUES ('PBH003','HH004','8000','200','1600000')

INSERT INTO CHITIETPHIEUBANHANG
VALUES ('PBH004','HH005','6000','500','3000000')

INSERT INTO CHITIETPHIEUBANHANG
VALUES ('PBH005','HH004','8000','500','4000000')

-------------CHI TI?T PHI?U Ð?T HÀNG------------
INSERT INTO CHITIETPHIEUDATHANG
VALUES ('PDH001','HH002','300')

INSERT INTO CHITIETPHIEUDATHANG
VALUES ('PDH002','HH003','1000')

INSERT INTO CHITIETPHIEUDATHANG
VALUES ('PDH003','HH005','500')

INSERT INTO CHITIETPHIEUDATHANG
VALUES ('PDH004','HH001','200')

------------CHI TI?T PHI?U NH?N HÀNG-----------
INSERT INTO CHITIETPHIEUNHANHANG
VALUES ('PNH001','HH004','5000','500','','PDH003')

INSERT INTO CHITIETPHIEUNHANHANG
VALUES ('PNH002','HH001','10000','200','','PDH004')

INSERT INTO CHITIETPHIEUNHANHANG
VALUES ('PNH003','HH002','15000','200','','PDH001')

--------------PHI?U S? C?------------------
INSERT INTO PHIEUSUCO
VALUES ('PSC001','HH001','10/12/2005','','50','10000','')

INSERT INTO PHIEUSUCO
VALUES ('PSC002','HH002','01/01/2006','','100','15000','')



---------------T?N KHO------------------


















 




